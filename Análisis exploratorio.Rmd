---
title: "Análisis exploratorio"
author: 
  - "Pablo Daniel Barillas Moreno, Carné No. 22193"
  - "Mathew Cordero Aquino, Carné No. 22982"
  - "Realizado por:"
output:
  pdf_document: default
  html_document: default
date: "2025-02-02"
header-includes:
   - \usepackage{fvextra}
   - \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
repository: "https://github.com/DanielBarillas/Miner-a_de_datos_Proyecto1_Entrega1_Grupo1"
---

### Enlace al Repositorio del Grupo #1
[Repositorio en GitHub](https://github.com/DanielBarillas/Miner-a_de_datos_Proyecto1_Entrega1_Grupo1.git)


```{r setup, include=FALSE} 
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
library(dplyr)
library(ggplot2)
library(tidyr)
library(nortest)
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
```

# 1. Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos. 
### Exploración Rápida del Dataset:
```{r}
# Resumen estadístico de todo el dataset
resumen_dataset <- summary(movies)

# Mostrar el resumen
resumen_dataset
```
### Ahora analicemos todo lo que se pueda del resumen estadístico de todo el dataset y organicémoslo 

### Número de películas y variables
```{r}
num_peliculas <- nrow(movies)
num_variables <- ncol(movies)
cat("- Total de películas:", num_peliculas, "\n")
cat("- Total de variables:", num_variables, "\n\n")
```


### Tipos de datos
```{r}
tipos_datos <- sapply(movies, class)
print(tipos_datos)
```

### Valores faltantes por variable
```{r}
valores_faltantes <- colSums(is.na(movies))
print(valores_faltantes[valores_faltantes > 0])
```

### Resumen Estadístico de Variables Cuantitativas
```{r}
variables_cuantitativas <- c("budget", "revenue", "voteAvg", "voteCount", "runtime")
resumen_cuantitativo <- summary(movies[, variables_cuantitativas])
knitr::kable(as.data.frame(resumen_cuantitativo), format = "html", caption = "Resumen Estadístico de Variables Cuantitativas")
```

### Resumen de variables cualitativas en una tabla compacta
```{r}
variables_cualitativas <- c("genres", "originalLanguage", "productionCountry")

# Crear un resumen con las 5 categorías más frecuentes para cada variable
resumen_cualitativas <- lapply(variables_cualitativas, function(var) {
  distribucion <- sort(table(movies[[var]]), decreasing = TRUE) # Ordenar frecuencias descendentes
  top_5 <- head(distribucion, 5) # Tomar las 5 más comunes
  return(data.frame(Categoría = names(top_5), Frecuencia = as.vector(top_5)))
})

# Mostrar el resumen en forma de tablas
names(resumen_cualitativas) <- variables_cualitativas

for (var in names(resumen_cualitativas)) {
  cat("\n- Variable:", var, "\n")
  print(resumen_cualitativas[[var]])
}
```


```{r}
# Identificar y eliminar registros con valores faltantes en 'originalLanguage' o 'productionCountry'
movies_cleaned <- movies %>%
  filter(!is.na(originalLanguage) & originalLanguage != "",
         !is.na(productionCountry) & productionCountry != "")

# Resumen después de la limpieza
num_peliculas_original <- nrow(movies)
num_peliculas_cleaned <- nrow(movies_cleaned)

cat("Películas originales en el dataset:", num_peliculas_original, "\n")
cat("Películas después de la limpieza:", num_peliculas_cleaned, "\n")
cat("Películas eliminadas por datos faltantes:", num_peliculas_original - num_peliculas_cleaned, "\n")
```


### Conclusiones y Observaciones
1. El conjunto de datos contiene 10,000 películas con información en 27 variables. Variables importantes como 'budget', 'revenue' y 'voteAvg' permiten un análisis financiero y de popularidad.

2. El análisis de las variables cualitativas como 'genres' muestra que hay géneros que predominan ampliamente, lo que refleja las tendencias de producción de la industria cinematográfica. Sin embargo, algunos géneros tienen muy pocas observaciones, lo que podría indicar nichos específicos.

3. Algunas variables, como 'budget' y 'revenue', contienen valores faltantes que deben manejarse para evitar sesgos.

4. Las variables cuantitativas 'voteAvg', 'voteCount', 'budget', y 'revenue' presentan una amplia variación, lo que sugiere que algunas películas tienen un éxito considerablemente mayor en términos de ingresos y popularidad en comparación con otras.

5.'runtime' presenta valores extremos, con películas de duración muy corta y muy larga. Este rango amplio puede estar influido por documentales, cortometrajes o películas experimentales.

6. Concentración de Información:

7. En las variables cualitativas, como 'productionCountry', se observó que unos pocos países concentran la mayoría de las producciones, mientras que otros aparecen con muy pocas películas. Esto refleja una concentración geográfica en la industria cinematográfica.

8. Las variables 'budget', 'revenue', 'originalLanguage', y 'productionCountry' tienen valores faltantes que pueden influir significativamente en los análisis y predicciones si no se manejan adecuadamente.

9. Tras la limpieza de datos, se eliminaron películas que no tenían información en 'originalLanguage' o 'productionCountry', lo que indica problemas de calidad de datos en el dataset original. Esto puede limitar ciertos análisis, como la evaluación de tendencias por país o idioma.

# 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta)
```{r}
tipos_variables <- data.frame(
  Variable = names(movies),
  Tipo = sapply(movies, function(columna) {
    valores_unicos <- length(unique(columna))
    tipo_dato <- class(columna)
    
    if (tipo_dato %in% c("integer", "numeric")) {
      if (valores_unicos < 20) {
        return("Cuantitativa Discreta")
      } else {
        return("Cuantitativa Continua")
      }
    } else {
      if (valores_unicos < 20) {
        return("Cualitativa Ordinal")
      } else {
        return("Cualitativa Nominal")
      }
    }
  })
)
```

### Resumir los resultados
```{r}
cat("\n--- Resumen de la Clasificación de Variables ---\n")
table(tipos_variables$Tipo)
```

### Mostrar solo un resumen de las variables más representativas (primeras filas de cada tipo)
```{r}
cat("\n--- Ejemplo de Variables Clasificadas ---\n")
print(head(tipos_variables, n = 27))
```

### Análisis y conclusiones
1. Distribución General:

Se observó que la mayoría de las variables son cualitativas nominales, lo cual indica que el dataset contiene principalmente información categórica, útil para análisis descriptivos y de clasificación.

2. Variables Cuantitativas:

Las variables 'budget', 'revenue', 'voteAvg' y 'runtime' son cuantitativas continuas, lo que proporciona métricas clave para evaluar aspectos financieros y de popularidad de las películas.
Las variables cuantitativas discretas (por ejemplo, conteos) son escasas, lo que limita ciertos tipos de análisis como frecuencias absolutas directas.

3. Importancia de las Variables Cualitativas:

Variables como 'genres', 'originalLanguage' y 'productionCountry' son críticas para identificar patrones de producción y popularidad según el contexto cultural y de mercado.

4. Categorías Redundantes o Vacías:

Se identificaron posibles categorías redundantes o vacías en algunas variables cualitativas, como 'originalLanguage' o 'productionCountry', lo cual podría requerir limpieza de datos para evitar sesgos.

5. Impacto en el Análisis:

Las variables cuantitativas continuas permitirán evaluar métricas clave como la correlación entre presupuesto e ingresos, mientras que las variables cualitativas proporcionan insights contextuales valiosos.

6. Posibles Limpiezas y Agrupaciones:

Variables como 'genres' pueden necesitar agrupaciones en categorías principales para evitar un exceso de clases únicas, que pueden dificultar la interpretación de los resultados.

7. Relación entre Tipos de Variables:

Las variables cualitativas podrían influir significativamente en las métricas cuantitativas (por ejemplo, el género o país de producción en los ingresos), lo cual sería un punto interesante para análisis más avanzados.

### 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.

```{r}
variables_cuantitativas <- c("budget", "revenue", "voteAvg", "voteCount", "runtime")

# Evaluar si las variables cuantitativas siguen una distribución normal
cat("\n--- Pruebas de Normalidad para Variables Cuantitativas ---\n")
resultados_normalidad <- lapply(variables_cuantitativas, function(var) {
  datos <- na.omit(movies[[var]]) # Eliminar valores faltantes
  if (length(datos) > 3) { # La prueba requiere al menos 3 datos
    prueba <- lillie.test(datos) # Prueba de Lilliefors (Kolmogorov-Smirnov ajustada)
    return(data.frame(Variable = var, P_Value = prueba$p.value))
  } else {
    return(data.frame(Variable = var, P_Value = NA))
  }
})

# Combinar resultados en un solo dataframe
tabla_normalidad <- do.call(rbind, resultados_normalidad)

# Determinar si hay normalidad (P-valor > 0.05 indica que la variable sigue una distribución normal)
tabla_normalidad$Normalidad <- ifelse(tabla_normalidad$P_Value > 0.05, "Sí", "No")
print(tabla_normalidad)

# Crear tablas de frecuencias para variables cualitativas
cat("\n--- Tablas de Frecuencia para Variables Cualitativas ---\n")
variables_cualitativas <- c("genres", "originalLanguage", "productionCountry")

frecuencias_cualitativas <- lapply(variables_cualitativas, function(var) {
  distribucion <- sort(table(movies[[var]]), decreasing = TRUE) # Ordenar por frecuencia
  top_5 <- head(distribucion, 5) # Tomar las 5 categorías más comunes
  return(data.frame(Categoría = names(top_5), Frecuencia = as.vector(top_5)))
})

# Mostrar resumen de tablas de frecuencias
names(frecuencias_cualitativas) <- variables_cualitativas
for (var in names(frecuencias_cualitativas)) {
  cat("\n---", var, "---\n")
  print(frecuencias_cualitativas[[var]])
}

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")
cat("- Las pruebas de normalidad indican que:\n")
for (i in 1:nrow(tabla_normalidad)) {
  cat("  - La variable", tabla_normalidad$Variable[i], "sigue una distribución normal:", tabla_normalidad$Normalidad[i], "\n")
}

cat("\n- Tablas de frecuencia muestran las categorías más comunes para las variables cualitativas:\n")
for (var in names(frecuencias_cualitativas)) {
  cat("  - En", var, "las categorías más frecuentes son:\n")
  print(frecuencias_cualitativas[[var]])
}
cat("\nConclusión:\n")
cat("- Las variables cuantitativas tienen diferentes distribuciones; solo algunas pueden aproximarse a la normalidad.\n")
cat("- Las categorías principales en variables cualitativas como 'genres' y 'originalLanguage' pueden guiar el análisis de tendencias.\n")
```

### 4.	Responda las siguientes preguntas:  

### 4.1. ¿Cuáles son las 10 películas que contaron con más presupuesto? 
```{r}
# Seleccionar las 10 películas con mayor presupuesto
top_budget_movies <- movies %>%
  select(title, budget) %>%
  arrange(desc(budget)) %>%
  head(10)

# Mostrar las 10 películas con mayor presupuesto
cat("\n--- Las 10 películas con mayor presupuesto ---\n")
print(top_budget_movies)

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")
# Resumen estadístico del presupuesto de estas películas
presupuesto_stats <- summary(top_budget_movies$budget)
print(presupuesto_stats)

# Conclusiones
cat("- Estas películas tienen presupuestos significativamente altos en comparación con el promedio del dataset.\n")
cat("- La película con el mayor presupuesto es:", top_budget_movies$title[1], "con un presupuesto de", top_budget_movies$budget[1], "USD.\n")
cat("- Estas producciones suelen corresponder a franquicias o estudios con alta inversión, lo que podría estar relacionado con mayores expectativas de ingresos.\n")
cat("- Este análisis ayuda a identificar tendencias en las películas más costosas y a analizar su desempeño financiero en relación con sus ingresos.\n")

```

### 4.2. ¿Cuáles son las 10 películas que más ingresos tuvieron? 
```{r}
# Seleccionar las 10 películas con mayores ingresos
top_revenue_movies <- movies %>%
  select(title, revenue) %>%
  arrange(desc(revenue)) %>%
  head(10)

# Mostrar las 10 películas con mayores ingresos
cat("\n--- Las 10 películas con mayores ingresos ---\n")
print(top_revenue_movies)

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")

# Resumen estadístico de los ingresos de estas películas
revenue_stats <- summary(top_revenue_movies$revenue)
print(revenue_stats)

# Calcular la película con mayores ingresos
pelicula_mas_ingresos <- top_revenue_movies[1, ]
cat("- La película con los mayores ingresos es:", pelicula_mas_ingresos$title, 
    "con un ingreso total de", pelicula_mas_ingresos$revenue, "USD.\n")

# Conclusiones
cat("- Las películas con los mayores ingresos suelen pertenecer a franquicias conocidas o contar con producciones de alto nivel.\n")
cat("- El rango de ingresos de estas películas es significativamente alto, indicando un éxito comercial sobresaliente.\n")
cat("- Este análisis permite identificar patrones en las películas más exitosas económicamente y su impacto en la industria cinematográfica.\n")
```

### 4.3. ¿Cuál es la película que más votos tuvo? 
```{r}
most_voted_movie <- movies %>%
  select(title, voteCount) %>%
  arrange(desc(voteCount)) %>%
  head(1)

# Mostrar la película con más votos
cat("\n--- Película con más votos ---\n")
print(most_voted_movie)

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")

# Detalles de la película con más votos
cat("- La película con más votos es:", most_voted_movie$title, 
    "con un total de", most_voted_movie$voteCount, "votos.\n")

# Posibles razones para el alto número de votos
cat("- El alto número de votos puede estar relacionado con la popularidad general de la película, el elenco o la franquicia.\n")
cat("- Es probable que esta película haya tenido una gran base de fans o una fuerte estrategia de marketing que impulsó su recepción en plataformas de votación.\n")

# Conclusión
cat("- Identificar películas con altos votos puede ayudar a entender qué características atraen a las audiencias y generan interacción.\n")
```

### 4.4. ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios? 
```{r}
# Seleccionar la peor película según el promedio de votos
worst_movie <- movies %>%
  select(title, voteAvg) %>%
  arrange(voteAvg) %>%
  head(1)

# Mostrar la peor película según los votos
cat("\n--- La peor película según el promedio de votos ---\n")
print(worst_movie)

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")

# Detalles de la película con la peor calificación
cat("- La peor película según el promedio de votos es:", worst_movie$title, 
    "con un promedio de", worst_movie$voteAvg, "en la plataforma.\n")

# Posibles razones para la baja calificación
cat("- Las bajas calificaciones pueden deberse a problemas de calidad en la trama, actuaciones, dirección o simplemente a expectativas no cumplidas por parte del público.\n")
cat("- También podría tratarse de una producción menos popular, con menor presupuesto o limitada distribución.\n")

# Conclusión
cat("- Conocer las peores películas según los votos ayuda a identificar los factores que pueden generar una recepción negativa y evitar errores en futuras producciones.\n")
```

### 4.5. ¿Cuántas películas se hicieron en cada año? ¿En qué año se hicieron más películas? Haga un gráfico de barras
```{r}
# Calcular cuántas películas se hicieron en cada año
top_year_movies <- movies %>%
  mutate(releaseYear = as.numeric(substr(releaseDate, 1, 4))) %>% # Extraer el año de la fecha de lanzamiento
  group_by(releaseYear) %>%
  summarise(count = n()) %>%
  arrange(desc(count))

# Identificar el año con más películas
year_max_movies <- top_year_movies %>%
  filter(count == max(count))
cat("\n--- Año con más películas ---\n")
cat("El año con más películas fue", year_max_movies$releaseYear, "con", year_max_movies$count, "películas.\n")

# Seleccionar el año con más películas y otros 9 años con menos películas
comparison_years <- top_year_movies %>%
  filter(releaseYear != year_max_movies$releaseYear) %>%
  arrange(desc(count)) %>%
  head(9) %>%
  bind_rows(year_max_movies)

# Ordenar por número de películas (para gráfico más claro)
comparison_years <- comparison_years %>%
  arrange(desc(count))

# Crear indicador para resaltar el año con más películas
comparison_years <- comparison_years %>%
  mutate(Highlight = ifelse(releaseYear == year_max_movies$releaseYear, "Año con más películas", "Otros años"))

# Crear gráfico de barras
ggplot(comparison_years, aes(x = reorder(as.factor(releaseYear), -count), y = count, fill = Highlight)) +
  geom_bar(stat = "identity", alpha = 0.8) +
  scale_fill_manual(values = c("Año con más películas" = "red", "Otros años" = "blue")) +
  labs(title = "Comparación del año con más películas vs. otros años",
       x = "Año",
       y = "Cantidad de películas",
       fill = "Categoría") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")
cat("- El año con más películas fue", year_max_movies$releaseYear, "con un total de", year_max_movies$count, "películas.\n")
cat("- Comparado con otros 9 años seleccionados, este año resalta significativamente por la cantidad de producciones.\n")
cat("- Este gráfico destaca visualmente la diferencia entre este año y otros años con menos películas.\n")
cat("- Las razones para este auge en la producción pueden incluir avances tecnológicos, estrategias de mercado y una alta demanda del público.\n")
```

### 4.6. ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el conjunto de datos? Represéntelo usando un gráfico. ¿A qué género principal pertenecen las películas más largas? 
```{r}
# Extraer el año de la columna releaseDate
movies <- movies %>%
  mutate(releaseYear = as.numeric(substr(releaseDate, 1, 4)))

# Asegurarse de que el año de lanzamiento está disponible en el dataset
movies <- movies %>%
  mutate(releaseYear = as.numeric(substr(releaseDate, 1, 4)))

# 1. Identificar el género principal de las 20 películas más recientes
recent_movies <- movies %>%
  arrange(desc(releaseYear)) %>%
  head(20)

recent_genre_distribution <- table(recent_movies$genres)
recent_top_genre <- names(sort(recent_genre_distribution, decreasing = TRUE)[1])
cat("\n--- Género principal de las 20 películas más recientes ---\n")
print(recent_top_genre)

# 2. Identificar el género principal en todo el conjunto de datos
genre_distribution <- table(movies$genres)
most_common_genre <- names(sort(genre_distribution, decreasing = TRUE)[1])
cat("\n--- Género principal que predomina en el conjunto de datos ---\n")
print(most_common_genre)

# Crear gráfico para los 10 géneros más frecuentes en todo el dataset
top_genres <- sort(genre_distribution, decreasing = TRUE)[1:10]
top_genres_df <- data.frame(Género = names(top_genres), Frecuencia = as.vector(top_genres))

ggplot(top_genres_df, aes(x = reorder(Género, Frecuencia), y = Frecuencia)) +
  geom_bar(stat = "identity", fill = "blue", alpha = 0.7) +
  coord_flip() +
  labs(title = "Top 10 géneros más frecuentes en el dataset",
       x = "Género",
       y = "Frecuencia") +
  theme_minimal()

# 3. Identificar el género principal de las películas más largas
longest_movies <- movies %>%
  arrange(desc(runtime)) %>%
  head(10)

longest_genre_distribution <- table(longest_movies$genres)
longest_top_genre <- names(sort(longest_genre_distribution, decreasing = TRUE)[1])
cat("\n--- Género principal de las películas más largas ---\n")
print(longest_top_genre)

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")
cat("- El género principal de las 20 películas más recientes es:", recent_top_genre, ". Esto refleja tendencias actuales en la industria cinematográfica.\n")
cat("- El género principal en todo el conjunto de datos es:", most_common_genre, ", lo que indica una preferencia general en la producción.\n")
cat("- El género principal de las películas más largas es:", longest_top_genre, ". Esto sugiere que ciertos géneros requieren más tiempo de metraje para desarrollar historias complejas.\n")
cat("- Visualizar los géneros más frecuentes permite entender qué tipos de películas dominan la industria y cómo evolucionan con el tiempo.\n")
```

### 4.7. ¿Las películas de qué genero principal obtuvieron mayores ganancias? 
```{r}
# Cargar librerías necesarias
library(dplyr)

# Calcular las ganancias de cada película
movies <- movies %>%
  mutate(profit = revenue - budget) # Crear la columna de ganancias (profit)

# Calcular las ganancias totales por género
genre_profit <- movies %>%
  filter(genres != "") %>% # Filtrar géneros no vacíos
  group_by(genres) %>%
  summarise(total_profit = sum(profit, na.rm = TRUE)) %>% # Sumar ganancias por género
  arrange(desc(total_profit)) # Ordenar en orden descendente por ganancias

# Mostrar los 5 géneros con mayores ganancias
cat("\n--- Géneros con mayores ganancias ---\n")
top_genre_profit <- head(genre_profit, 5)
print(top_genre_profit)

# Identificar el género con mayores ganancias
top_genre <- top_genre_profit[1, ]
cat("\n--- Género con mayores ganancias ---\n")
cat("El género con mayores ganancias es:", top_genre$genres, 
    "con un total de", top_genre$total_profit, "USD.\n")

# Crear un gráfico de los 5 géneros más rentables
ggplot(top_genre_profit, aes(x = reorder(genres, -total_profit), y = total_profit)) +
  geom_bar(stat = "identity", fill = "green", alpha = 0.7) +
  labs(title = "Top 5 géneros con mayores ganancias",
       x = "Género",
       y = "Ganancias Totales (USD)") +
  theme_minimal() +
  coord_flip()

# Análisis y conclusiones
cat("\n--- Análisis y Conclusiones ---\n")
cat("- El género con mayores ganancias es:", top_genre$genres, 
    "con un total de", top_genre$total_profit, "USD.\n")
cat("- Los géneros más rentables suelen incluir producciones de alto presupuesto con gran éxito en taquilla.\n")
cat("- Este análisis permite identificar los géneros más lucrativos, lo que puede guiar decisiones estratégicas en producción y marketing.\n")
cat("- Visualizar las ganancias totales por género ayuda a priorizar inversiones en géneros con mayor potencial económico.\n")
```

### 4.8. ¿La cantidad de actores influye en los ingresos de las películas?¿se han hecho películas con más actores en los últimos años? 
```{r}
# Cargar librerías necesarias
library(dplyr)
library(ggplot2)

# 1. Relación entre la cantidad de actores y los ingresos
cat("\n--- Análisis: Relación entre cantidad de actores e ingresos ---\n")

# Crear un gráfico de dispersión con línea de tendencia
ggplot(movies, aes(x = actorsAmount, y = revenue)) +
  geom_point(alpha = 0.5, color = "blue") +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Relación entre la cantidad de actores y los ingresos",
       x = "Cantidad de Actores",
       y = "Ingresos (USD)") +
  theme_minimal()

# Análisis inicial de correlación
correlation <- cor(movies$actorsAmount, movies$revenue, use = "complete.obs")
cat("La correlación entre la cantidad de actores y los ingresos es:", correlation, "\n")
cat("- Una correlación positiva indica que más actores tienden a generar mayores ingresos.\n")
cat("- Sin embargo, valores extremos o géneros específicos pueden influir en esta relación.\n")

# 2. Evolución del número de actores en las películas por año
cat("\n--- Análisis: Evolución del número de actores en las películas ---\n")

# Calcular el promedio de actores por año
actors_per_year <- movies %>%
  group_by(releaseYear) %>%
  summarise(avg_actors = mean(actorsAmount, na.rm = TRUE))

# Crear un gráfico de líneas para visualizar la tendencia
ggplot(actors_per_year, aes(x = releaseYear, y = avg_actors)) +
  geom_line(color = "blue") +
  geom_point(color = "red") +
  labs(title = "Evolución del número de actores en las películas por año",
       x = "Año",
       y = "Promedio de Actores") +
  theme_minimal()

# Identificar el año con el promedio más alto de actores
max_avg_actors <- actors_per_year %>%
  filter(avg_actors == max(avg_actors, na.rm = TRUE))
cat("El año con el mayor promedio de actores es:", max_avg_actors$releaseYear,
    "con un promedio de", max_avg_actors$avg_actors, "actores.\n")

# Conclusiones
cat("\n--- Análisis y Conclusiones ---\n")
cat("- La correlación entre la cantidad de actores y los ingresos es de:", correlation, "\n")
cat("  Esto sugiere que, aunque más actores pueden contribuir a mayores ingresos, la relación no es extremadamente fuerte.\n")
cat("- El análisis muestra que las películas con más actores tienden a ser producidas en años recientes, reflejando una tendencia creciente en la industria.\n")
cat("- Estas tendencias pueden ser el resultado de mayores producciones en géneros como acción o aventuras, donde se requieren grandes elencos.\n")
cat("- Comprender esta relación es clave para equilibrar costos y beneficios al planificar el reparto en futuras producciones.\n")

```


### 4.9 ¿Es posible que la cantidad de hombres y mujeres en el reparto influya en la popularidad y los ingresos de las películas?

Primero obtendremos la relacion entre hombres e ingresos.


```{r}
ggplot(movies, aes(x = as.numeric(castMenAmount), y = revenue)) +
  geom_point(alpha = 0.5, color = "green") +
  geom_smooth(method = "lm", formula = y ~ poly(x, 2), color = "purple") +
  labs(title = "Relación entre la cantidad de actores hombres y los ingresos",
       x = "Cantidad de Actores Hombres",
       y = "Ingresos") +
  scale_x_continuous(limits = c(0, 200)) + 
  theme_minimal()

```

##### Grafica de Dispersion Cantidad Hombres vs Ingresos , 200 datos posibles 



Si no lo acotamos en el eje x nos daria

```{r}
echo=FALSE
ggplot(movies, aes(x = as.numeric(castMenAmount), y = revenue)) +
  geom_point(alpha = 0.5, color = "green") +
  geom_smooth(method = "lm", color = "purple") +
  labs(title = "Relación entre la cantidad de actores hombres y los ingresos",
       x = "Cantidad de Actores Hombres",
       y = "Ingresos")+
  theme_minimal()

```



#### Analisis Grafico
Como se puede observar en la grafica de dispersion, tiende a mas ingresos mientras mas numeros de hombres existan pero ojo esto no es asi ya que a partir de cierto punto empieza a bajar drasticamente los ingresos. Esto se ve en la segunda grafica donde la cantidad de hombres baja considerablemente. Muy posiblemente debido a que mientras mas actores las personas pierden interes.



Ahora obtendremos la relacion de mujeres

```{r}
ggplot(movies, aes(x = as.numeric(castWomenAmount), y = revenue)) +
  geom_point(alpha = 0.5, color = "pink") +
  geom_smooth(method = "lm",  formula = y ~ poly(x, 2), color = "red") +
  labs(title = "Relación entre la cantidad de actores mujeres y los ingresos",
       x = "Cantidad de Actores Mujeres",
       y = "Ingresos") +
  scale_x_continuous(limits = c(0, 200))+
  theme_minimal()
```

Si no lo acotamos en el eje x nos daria
```{r}
ggplot(movies, aes(x = as.numeric(castWomenAmount), y = revenue)) +
  geom_point(alpha = 0.5, color = "pink") +
  geom_smooth(method = "lm",  formula = y ~ poly(x, 2), color = "red") +
  labs(title = "Relación entre la cantidad de actores mujeres y los ingresos",
       x = "Cantidad de Actores Mujeres",
       y = "Ingresos")+
  theme_minimal()
```

#### Analisis Grafico
Como se puede observar en la primera grafica tiende a existir mas ingresos mientras mas mujeres existan , sin embargo al igual que con la de los hombres esta suele decaer en cierto punto maximo hasta alcanzar a llegar a minimos de ingresos como se ve en la segunda grafica.


Ahora analizaremos su popularidad

#### Popularidad Hombres
```{r}
ggplot(movies, aes(x = as.numeric(castMenAmount), y = popularity)) +
  geom_point(alpha = 0.5, color = "green") +
  geom_smooth(method = "lm",formula = y ~ poly(x, 6), color = "red") +
  labs(title = "Relación entre la cantidad de actores hombres y los ingresos",
       x = "Cantidad de Actores Hombres",
       y = "Popularidad")+
  scale_x_continuous(limits = c(0, 200))+
  theme_minimal()
```

#### Popularidad Mujeres
```{r}
ggplot(movies, aes(x = as.numeric(castWomenAmount), y = popularity)) +
  geom_point(alpha = 0.5, color = "pink") +
  geom_smooth(method = "lm", color = "red") +
  labs(title = "Relación entre la cantidad de actores mujeres y la popularidad",
       x = "Cantidad de Actores Mujeres",
       y = "Popularidad") +
     scale_x_continuous(limits = c(0, 200)) +  # Limitar el rango en el eje X
  theme_minimal()
```


#### Analisis Grafico
Como se puede observar en los hombres suele existir una distribucion de hombres con mayor popularidad en las peliculas que participan. En cambio en las mujeres las peliculas en las que menor cantidad de actrices suelen ser las que tienen mayor popularidad. 


#### Conclusiones
La cantidad de actores de ambos generos mientras mayor sea la popularidad y los ingresos de la pelicula bajan.Muy posiblemente a que mientras mas actores sean mayor costo de produccion y menor la retencion de las personas en los personajes. De igual forma se ve una tendencia a que mientras mayor sea la cantidad de mujeres mejora la taquilla pero no lo hace en la popularidad de la pelicula.

### 4.10 ¿Quiénes son los directores que hicieron las 20 películas mejor calificadas?
```{r}
library(knitr)
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
movies[] <- lapply(movies, function(x) iconv(x, from = "latin1", to = "UTF-8", sub = "byte"))

movies <- movies %>%
  mutate(voteAvg = as.numeric(voteAvg))  # Convertir voteAVG a numero

top_20_movies <- movies %>%
  filter(director != "") %>%
  arrange(desc(voteAvg)) %>%
  select(title, director, voteAvg) %>%
  head(20)
knitr::kable(top_20_movies, format = "html")
```


#### Conclusiones
Se puede observar que los 20 directores con las peliculas mejor calificadas suelen ser de un rango de 9.0 a  10  de nota dada por la critica. Lo cual es un buen indicativo de la capacidad de los directores de poder conseguir buena critica. 


### 4.11 ¿Cómo se correlacionan los presupuestos con los ingresos?
Para ello haremos una grafica de correlacion

```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
movies$budget <- as.numeric(movies$budget)
movies$revenue <- as.numeric(movies$revenue)

x <- movies$budget
y <-movies$revenue

# Creamos el gráfico
plot(x, y, pch = 19, col = "lightblue", 
     xlab = "Presupuesto",  # Título del eje X
     ylab = "Ingresos") 

# Línea de regresión
abline(lm(y ~ x), col = "red", lwd = 3)


text(paste("Correlación Presupuesto e Ingresos:", round(cor(x, y), 2)), x = 25, y = 95)

```


#### Conclusiones
Como se puede observar en el gráfico de dispersión si hay una relación que tiende a un mayor presupuesto una mayor recaudación. Esto se debe a que una parte de los presupuestos se suele destinar a la publicidad lo que puede influir en su crecimiento. Sin embargo podemos observar ciertos puntos atípicos por encima y debajo de la linea de tendencia que muestran que muchas veces con menor presupuesto se logran una gran cantidad de ingresos y con mucho presupuesto suelen tener ingresos muy bajos. Aun asi la correlacion es muy alta siendo de 0.76 lo que indica que hay una correlacion entre ambas variables. 

### 4.12  ¿Se asocian ciertos meses de lanzamiento con mejores ingresos?
Para ello agruparemos los meses y calcularemos el total de ingresos
```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
movies$releaseMonth <- as.numeric(substr(movies$releaseDate, 6, 7))


monthly_revenue <- movies %>%
  group_by(releaseMonth) %>%
  summarise(total_revenue = sum(revenue, na.rm = TRUE),
            avg_revenue = mean(revenue, na.rm = TRUE))%>%
  select(releaseMonth,total_revenue,avg_revenue)%>%
  arrange(desc(avg_revenue)) 
  



knitr::kable(monthly_revenue, format = "html")
```



#### Conclusiones
Si hay una asociación, haciendo una métrica de total de ingresos y promedio de ingresos se puede ver que el mes con mas recaudación es junio , mayo y julio. Esto se puede deber a que son los meses de vacaciones de verano y muchas personas asisten a ver películas en tiempos libres. 

### 4.13  ¿En qué meses se han visto los lanzamientos con mejores ingresos? ¿cuantas películas, en promedio, se han lanzado por mes?

Viendo  la tabla anterior se puede ver que los meses de juion, mayo y julio siguien siendo los mejores meses para poder lanzar una pelicula al tener los mayores ingresos.

Ahora encontraremos el total de peliculas lanzadas.
```{r}
#El total seria
count_movie_month_total <- movies %>%
  group_by(releaseMonth) %>%
  summarise(movie_count = n())%>%
  select(releaseMonth,movie_count)%>%
  arrange(desc(movie_count))
  
knitr::kable(count_movie_month_total, format = "html")
```


Como siguiente paso veremos el promedio de peliculas por año
```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
movies$releaseYear <- as.numeric(substr(movies$releaseDate, 1, 4))
movies$releaseMonth <- as.numeric(substr(movies$releaseDate, 6, 7))
count_movie_month <- movies %>%
  group_by(releaseMonth, releaseYear) %>%
  summarise(movie_count = n(), .groups = 'drop')


# Calcular el promedio de películas por mes
average_movies_per_month <- count_movie_month %>%
  group_by(releaseMonth) %>%
  summarise(avg_movie_count = mean(movie_count))%>%
  select(releaseMonth,avg_movie_count)%>%
  arrange(desc(avg_movie_count))

print(average_movies_per_month)
```

#### Conclusiones
Podemos observar que en total de peliculas lanzadas la mayoria en promedio y total han sido siempre en Septiembre. Y el mes de Junio ha sido si bien el que mejor ingresos ha tenido en el que menos peliculas en promedio se han lanzado siendo de 11 aproximadamente. Y 819 en total de peliculas lanzadas, sin embargo se han recaudado mayor cantidad de ingresos en dicho mes. Muy posiblemente debido a las vacaciones de verano que inician en Junio y terminan en Septiembre, y son epocas en donde los padres llevan a sus hijos a ver peliculas. 

Por lo que si se quiere lanzar una pelicula seria entre los meses 5, 6 , 7 y 8 . Debido a que son los meses en donde no se estan haciendo tantos lanzamientos para cada uno , pero si estan rindiendo en ingresos. 

Lo que se recomienda es tomar en cuenta la popularidad de las peliculas por cada mes, para asi poder tener una perspectiva contra que se compite. 

### 4.14  ¿Cómo se correlacionan las calificaciones con el éxito comercial?

Para ello realizaremos una grafica de correlacion entre su exito que se podria ver como la diferencia entre ingresos - presupuesto / ingresos que es un porcentaje de ganancia que se tiene para la pelicula y en el eje y tendremos su calificacion 

```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
# Reemplazar NA e Inf en 'revenue', 'budget', y 'voteAvg' por la mediana
movies$revenue[is.na(movies$revenue) | is.infinite(movies$revenue)] <- median(movies$revenue, na.rm = TRUE)
movies$budget[is.na(movies$budget) | is.infinite(movies$budget)] <- median(movies$budget, na.rm = TRUE)
movies$voteAvg[is.na(movies$voteAvg) | is.infinite(movies$voteAvg)] <- median(movies$voteAvg, na.rm = TRUE)

# Calcular las ganancias (gains)
movies$ganancia_neta <- ifelse(as.numeric(movies$revenue) == 0, 0, 
                       (as.numeric(movies$revenue) - as.numeric(movies$budget)) / as.numeric(movies$revenue))


x <- movies$voteAvg
y <- movies$ganancia_neta
plot(x, y, pch = 19, col = "lightblue", 
     xlab = "Promedio de Calificaciones",  # Título del eje X
     ylab = "Exito Comercial",
     ylim = c(0, max(y, na.rm = TRUE)))

# Agregar la línea de regresión
abline(lm(y ~ x), col = "red", lwd = 3)

text(paste("Correlación de Éxito comercial y Calificaciones:", round(cor(x, y), 2)), x = 25, y = 95)
```

#### Analisis Grafico
Este grafico nos muestra aquellos de 0 a 1 de ganancias. 1 es que generaron ganacias del 100% y 0% que su presupuesto no genero ganancias esto quiere decir que los ingresos apenas alcanzaron para cubrir los costes. Por otro lado tambien se clasifico como 0 aquellos que no solo no generaron ganancias sino que tampoco generaron ingresos.    Cabe aclarar que aqui se colocan todos aquellos que tienen exito comercial (osea apartir de 0) , pues hay peliculas con ganancias negativas las cuales son fracasos que perdieron dinero,  y por ende no se toman para el analisis. 

Si quitamos las que no tuvieron ingresos ya que tambien son fracasos tendriamos esto
```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)
# Reemplazar NA e Inf en 'revenue', 'budget', y 'voteAvg' por la mediana
movies$revenue[is.na(movies$revenue) | is.infinite(movies$revenue)] <- median(movies$revenue, na.rm = TRUE)
movies$budget[is.na(movies$budget) | is.infinite(movies$budget)] <- median(movies$budget, na.rm = TRUE)
movies$voteAvg[is.na(movies$voteAvg) | is.infinite(movies$voteAvg)] <- median(movies$voteAvg, na.rm = TRUE)

movies$gains <- (as.numeric(movies$revenue) - as.numeric(movies$budget)) / as.numeric(movies$revenue)

# Eliminar valores Inf o NA en 'gains'
movies <- movies[is.finite(movies$gains), ]

x <- movies$voteAvg
y <-  movies$gains
plot(x, y, pch = 19, col = "lightblue", 
     xlab = "Promedio de Calificaciones ",  # Título del eje X
     ylab = "Éxito Comercial (Ganancia Neta)",
     ylim = c(0, max(y, na.rm = TRUE)))

# Agregar la línea de regresión
abline(lm(y ~ x), col = "red", lwd = 3)

text(paste("Correlación de Éxito comercial y Calificaciones:", round(cor(x, y), 2)), x = 25, y = 95)
```


#### Analisis Grafico
Existe relacion, tambien podemos observar que la mayoria en promedio es calificada con un 6, vemos que una parte importante de las peliculas que son calificadas por la critica por debajo del 6 tienen una ganancia neta del 100%. Lo que indica que su ingresos supero o triplico la ganancias de las peliculas. Aun asi hay muchas cintas que lograron tener muy buena critica y tener un exito comercial.


#### Conclusion
Como se puede observar el exito comercial y las calificaciones, sin embargo una gran cantidad de peliculas con un puntaje mayor a 6. Hay tenido una rendimiento muy alto en sus ganancias. Lo cual indica que las personas si desean pagar por ver una pelicula buena . Y de hecho este exito puede ser muy influenciado en la percepcion de lo buena que sea una cinta. 


### 4.15  ¿Qué estrategias de marketing, como videos promocionales o páginas oficiales, generan mejores resultados?

Lo que haremos es comparar usando la ganancia entre las 2 estrategias. 

### Marketing de Video

Si medimos sus ingresos veremos lo siguiente. 
```{r}

# Lo primero que haremos es mapear
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)


marketing <- movies %>%
  select(video, revenue)

# Ahora balanceamos
video_1 <- marketing %>% filter(video == TRUE)

# Seleccionar aleatoriamente 84 observaciones de video = 0 y de N/A
set.seed(123)  # Asegura reproducibilidad
video_0_sample <- marketing %>%
  filter(video == FALSE) %>%
  sample_n(84)

video_na_sample <- marketing %>%
  filter(is.na(video)) %>%
  sample_n(84)


# Unir ambos subconjuntos para tener balanceado el dataset
balanced_marketing <- bind_rows(video_1, video_0_sample, video_na_sample)

balanced_counts <- balanced_marketing %>%
  count(video)

print(balanced_counts)


balanced_marketing %>%
  group_by(video) %>%
  summarise(avg_revenue = mean(revenue, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(video), y = avg_revenue, fill = factor(video))) +
  geom_col() +
  labs(title = "Ingresos promedio según Video",
       x = "¿Tiene video?",
       y = "Ingreso promedio") +
  theme_minimal()


```

#### Analisis Grafico

Lo que vemos aqui es el promedio de ingresos dependiendo si tiene video o no tiene.  Por lo que se ve aqui es que no es concluyente por ende no se puede decir que tener o no video afecta a los ingresos percibidos. Pues tenemos demasiados valores que no conocemos si tienen o no video, por ende no se puede hacer una conclusion.  Pero se puede ver que las que no tienen video tienen mayores ingresos. 


Ahora si medimos su popularidad veremos lo siguiente


```{r}

# Lo primero que haremos es mapear
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)


marketing <- movies %>%
  select(video, popularity)

# Ahora balanceamos
video_1 <- marketing %>% filter(video == TRUE)

# Seleccionar aleatoriamente 84 observaciones de video = 0 y de N/A
set.seed(123)  # Asegura reproducibilidad
video_0_sample <- marketing %>%
  filter(video == FALSE) %>%
  sample_n(84)

video_na_sample <- marketing %>%
  filter(is.na(video)) %>%
  sample_n(84)


# Unir ambos subconjuntos para tener balanceado el dataset
balanced_marketing <- bind_rows(video_1, video_0_sample, video_na_sample)

balanced_counts <- balanced_marketing %>%
  count(video)

print(balanced_counts)


balanced_marketing %>%
  group_by(video) %>%
  summarise(avg_popularity = mean(popularity, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(video), y = avg_popularity, fill = factor(video))) +
  geom_col() +
  labs(title = "Ingresos promedio según Video",
       x = "¿Tiene video?",
       y = "Popularidad promedio") +
  theme_minimal()


```
#### Analisis Grafico

Podemos ver que aquellas que tienen video suelen ser mucho mas populares que las que no. Esto puede deberse a que es muy comun en redes sociales que las que no tienen video suelan ser mas visitados su video que las que no,  sin embargo aun no es concluyente pues hay algunas que no se conocen si tienen o no. 



### Marketing de Paginas Web
Si medimos los ingresos si tienen pagina , nos daria. 

```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)

#Primero mapeamos si tiene como un string que tenga y si no tiene como N/A

marketing <- movies %>%
  select(homePage, revenue) %>%
  mutate(homePage = ifelse(is.na(homePage), FALSE, TRUE)) 
homePage_counts <- marketing %>%
  count(homePage)

print(homePage_counts)

#Ahora balanceamos
page_1 <- marketing %>% filter(homePage == TRUE)

set.seed(123)  # Asegura reproducibilidad
page_FALSE_sample <- marketing %>%
  filter(homePage == FALSE) %>%
  sample_n(4193)

balanced_marketing <- bind_rows(page_1,page_FALSE_sample)




balanced_counts <- balanced_marketing %>%
  count(homePage)

print(balanced_counts)


#Ahora graficamos


balanced_marketing %>%
  group_by(homePage) %>%
  summarise(avg_revenue = mean(revenue, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(homePage), y = avg_revenue, fill = factor(homePage))) +
  geom_col() +
  labs(title = "Ingresos promedio según pagina web",
       x = "¿Tiene pagina web ?",
       y = "Ingreso promedio") +
  theme_minimal()

```

#### Analisis Grafico
Podemos ver aqui que si tienen pagina web tiene una mayor cantidad de ingresos que al no tener una pagina web, siendo a simple vista casi el doble. Muy posiblemente debido a que internet suele ser una manera muy efectiva para promocionarse.



Si medimos la popularidad si tienen pagina , nos daria. 

```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)

#Primero mapeamos si tiene como un string que tenga y si no tiene como N/A

marketing <- movies %>%
  select(homePage, popularity) %>%
  mutate(homePage = ifelse(is.na(homePage), FALSE, TRUE)) 
homePage_counts <- marketing %>%
  count(homePage)

print(homePage_counts)

#Ahora balanceamos
page_1 <- marketing %>% filter(homePage == TRUE)

set.seed(123)  # Asegura reproducibilidad
page_FALSE_sample <- marketing %>%
  filter(homePage == FALSE) %>%
  sample_n(4193)

balanced_marketing <- bind_rows(page_1,page_FALSE_sample)




balanced_counts <- balanced_marketing %>%
  count(homePage)

print(balanced_counts)


#Ahora graficamos


balanced_marketing %>%
  group_by(homePage) %>%
  summarise(avg_popularity = mean(popularity, na.rm = TRUE)) %>%
  ggplot(aes(x = factor(homePage), y = avg_popularity, fill = factor(homePage))) +
  geom_col() +
  labs(title = "Ingresos promedio según pagina web",
       x = "¿Tiene pagina web ?",
       y = "Popularidad promedio") +
  theme_minimal()

```

#### Analisis Grafico
Podemos ver aqui que si llega a ser muy popular siguiendo la misma proporcion que los ingresos


#### Conclusion
Podemos ver que la mejor estrategia va a ser tener una pagina web, sin embargo se recomienda tambien tener un video , y colocarlo en las paginas web para poder apoyar a promocionar las peliculas, ya que el video si bien no rinde en ingresos si rinde en popularidad siendo mayor que no tenerlo .


### 4.16 ¿La popularidad del elenco está directamente correlacionada con el éxito de taquilla?

Para ello podemos hacer una grafica de correlacion. 
```{r}


# Leer el archivo CSV
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)

# Seleccionar las columnas de interés
popularity <- movies %>%
  select(actorsPopularity, revenue, budget)

# Convertir los valores de actorsPopularity que están separados por "|" en un vector numérico

popularity$actorsPopularity <- sapply(popularity$actorsPopularity, function(x) {
  # Convertir la cadena separada por "|" en un vector numérico
  values <- as.numeric(unlist(strsplit(x, "\\|")))
  # Retornar el primer valor de la lista como ejemplo (o puedes hacer un promedio si lo prefieres)
  return(values[1])  # O usa mean(values) si quieres promediar los valores
})

# Calcular la ganancia de taquilla
popularity$ganancia <- (popularity$revenue - popularity$budget) / popularity$revenue

# Filtrar los valores que sean finitos para evitar NaN o infinitos
popularity <- popularity[is.finite(popularity$ganancia), ]



ggplot(popularity, aes(x = actorsPopularity, y = ganancia, fill = ..level..)) +
  stat_density_2d(geom = "polygon") +
  labs(title = "Densidad de Popularidad del Elenco vs Ganancia de Taquilla",
       x = "Popularidad del Elenco",
       y = "Ganancia de Taquilla") +
  ylim(0, max(popularity$ganancia, na.rm = TRUE)) +  # Limita Y de 0 al máximo
  theme_minimal()




```

#### Analisis Grafico
Como podemos ver este grafico la densidad de los actores estan dentro de una ganancia muy alta y una popularidad del elenco siendo entre 10 a 20.  Por lo que se puede intuir en la grafica es que a mientras mas popularidad tenga un elenco puede exitir una mayor ganancia pero la mayoria de las peliculas suelen estar en el rango de una popularidad no tan alta y aun asi lograr exitos en la taquilla.



#### Conclusiones. 
Si bien la popularidad influye en las ganancias de una pelicula que sean buenas, no significa que sea el unico factor, debido a que ha habido cintas con menor cantidad de actores populares que han logrado ser muy bien recibidas por el publico. 



# 5 Genere usted otras seis preguntas que le parezcan interesantes.


### 5.1 ¿Cuál es la relación entre el presupuesto y la duración de las películas? ¿Las películas con mayor presupuesto tienden a ser más largas?

Para ello creamos una grafica de correlacion entre la duracion y el presupuesto.

```{r}

movies <- read.csv("movies.csv", stringsAsFactors = FALSE)

plot(x= movies$budget, y = movies$runtime, pch = 19, col = "lightblue", 
     xlab = "Presupuesto",  # Título del eje X
     ylab = "Tiempo de Duracion",
)

abline(lm(y ~ x), col = "red", lwd = 3)

```


#### Analisis grafico
Como se puede ver la mayoria de peliculas con un tiempo de duracion muy alto suelen tener un presupuesto muy bajo, casi siendo 0. Pero se nota una cierta tendencia a que las peliculas con mayor presupuesto su tiempo de duracion no sea tan largo. Al menos no mas de los 200 minutos.

#### Conclusion
Las peliculas con mayor presupuesto no tienden a ser mas largas al contrario siempre siguen la tendencia de durar menos de 200 minutos, la relacion entre estas 2 variables no es evidente. 


### 5.2 ¿Las peliculas mas largas tienden a tener mayores ingresos?

Para ello realizamos otra grafica

```{r}

movies <- read.csv("movies.csv", stringsAsFactors = FALSE)

plot(x= movies$runtime, y = movies$revenue, pch = 19, col = "lightblue", 
     xlab = "Tiempo de Duracion",  # Título del eje X
     ylab = "Ingresos",
)

abline(lm(y ~ x), col = "red", lwd = 3)

```

#### Analisis Grafico

Como se puede ver las peliculas mas largas a los 50 minutos si alcanzan una gran cantidad de ingresos, pero tambien llega a un maximo y a partir de ahi mientras mas larga la pelicula menos ingresos genera

#### Conclusion
Las personas si bien estan dispuestas a consumir peliculas larga, llega a un punto en donde la misma llega a perder retencion, debido a que no genera los ingresos necesarios. Por ende si se espera tener un buen rendimiento es necesario no sobrepasar por los 150 minutos .



### 5.3 ¿Cómo ha evolucionado la cantidad de películas por género a lo largo de los años?
Calcularemos las peliculas por genero. Y las agruparemos por año
```{r}
movies <- read.csv("movies.csv", stringsAsFactors = FALSE)

movies$releaseYear <- as.numeric(substr(movies$releaseDate, 1, 4))


movies_por_anio <- movies %>%
  select(title,releaseYear, genres) 

movies_por_anio <- movies_por_anio %>%
  separate_rows(genres, sep = "\\|") %>%  # Divide en varias filas
  group_by(genres, releaseYear) %>%      # Agrupa por género y año
  summarise(count = n(), .groups = "drop") # Cuenta las películas


ggplot(movies_por_anio, aes(x = releaseYear, y = count, fill = genres)) +
  geom_bar(stat = "identity", position = "dodge") +
  labs(title = "Número de películas por género y año", 
       x = "Año de estreno", 
       y = "Cantidad de películas") +
  theme_minimal() + 
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

#### Analisis Grafico
Se puede ver que a lo largo de todos los años todos los generos han tenido mayor cantidad de peliculas, siendo en el 2020 al 2025 donde se ha visto esta enorme tendencia. 

#### Conclusion
Como se puede ver la cantidad de generos ha aumentado sobre todo aquellos que son documentales o que tratan sobre crimen y drama. A pesar de ello se ha visto una disminucion de producciones el año 2025 y 2024. 




### 5.4 ¿Cuales fueron los paises que se rodaron filmes con mayor rendimiento?

Calcularemos la ganancia generada y luego la contrastaremos en un grafico de barras con respecto a los paises. 


```{r}

movies_por_pais <- movies %>%
  select(title, revenue, budget,productionCountry)

# Calculamos la ganancia
movies_por_pais$ganancia <- (movies_por_pais$revenue - movies_por_pais$budget) / movies_por_pais$revenue

# Filtramos valores finitos
movies_por_pais <- movies_por_pais[is.finite(movies_por_pais$ganancia), ]


movies_por_pais <- movies_por_pais %>%
  separate_rows(productionCountry, sep = "\\|")


movies_por_pais_promedio <- movies_por_pais %>%
  group_by(productionCountry) %>%
  summarise(promedio_ganancia = mean(ganancia), .groups = "drop")

top_20_paises <- movies_por_pais_promedio %>%
  arrange(desc(promedio_ganancia)) %>%
  head(20)

# Crear gráfico
ggplot(top_20_paises, aes(x = reorder(productionCountry, promedio_ganancia), y = promedio_ganancia)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(title = "Promedio de ganancia por país",
       x = "País", 
       y = "Promedio de ganancia") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotar etiquetas del eje X

```
#### Analisis Grafico
Como se puede observar los paises con mayor rendimiento son desde Australia a Vietnam y han tenido ganancias del 0.6 al 100% como ganancia neta con respecto a su presupuesto invertido

#### Conclusion
En conclusion si se desea un promedio de ganancias bueno es mejor filmar en estos paises, debido a que puede ser que los costos no se eleven tanto , y puede ayudar a generar peliculas que sean mas entretenidas y llamativas al publico al conocer lugares que no han visto. 


### 5.5 ¿Cual son los actores que mas recaudacion ha tenido?
Para ello realizaremos una tabla
```{r}


# Seleccionamos las columnas relevantes
movies_por_actor <- movies %>%
  select(actors, revenue)

# Limpiamos posibles caracteres no estándar en los nombres de los actores
movies_por_actor$actors <- iconv(movies_por_actor$actors, from = "UTF-8", to = "ASCII//TRANSLIT")

# Separamos a los actores en filas
movies_por_actor <- movies_por_actor %>%
  separate_rows(actors, sep = "\\|")

# Calculamos el promedio de ingresos por actor
movies_por_actor_promedio <- movies_por_actor %>%
  group_by(actors) %>%
  summarise(promedio_ingresos = mean(revenue, na.rm = TRUE), .groups = "drop")

# Ordenamos y seleccionamos los 20 actores con mayor promedio de ingresos
top_20_actores <- movies_por_actor_promedio %>%
  arrange(desc(promedio_ingresos)) %>%
  head(20)

# Imprimir los primeros 20 actores

knitr::kable(top_20_actores, format= "html")

```


#### Conclusion

Como se puede observar estos son los actores que mas ingresos si bien no han generado en promedio sus peliculas en las que han estado han tenido muchos ingresos. Ello puede servir para poder elegir que elenco de celebridades elegir para una nueva cinta. 



### 5.6 ¿Que idiomas de las peliculas son los mas consumidos (con mayor ingresos)?
```{r}
movies_por_lengua <- movies %>%
  select(originalLanguage, revenue )


# Calculamos el promedio de ingresos por lengua
movies_por_lengua_promedio <- movies_por_lengua %>%
  group_by(originalLanguage) %>%
  summarise(promedio_ingresos = mean(revenue, na.rm = TRUE), .groups = "drop")


top_20_lenguas <- movies_por_lengua_promedio %>%
  arrange(desc(promedio_ingresos)) %>%
  head(20)


knitr::kable(top_20_lenguas, format= "html")

```


#### Conclusion

Como se puede ver los idiomas de las peliculas que mas se consumen son el chino, el indi, el telugu , coreano e ingles. Esto se debe muy posiblemente a que son los paises con mayor consumo de peliculas , y ademas hay 2 paises siendo la India y China que tienen una gran poblacion de personas , lo que hace que las peliculas estrenadas ahi consigan muchos ingresos. 
